SCOPE="${{ parameters.Scope }}"

RESOURCE_GROUP=$(echo "$SCOPE" | awk -F'/' '{for (i=1; i<=NF; i++) if ($i=="resourceGroups") print $(i+1)}')
RESOURCE_TYPE=$(echo "$SCOPE" | awk -F'/' '{for (i=1; i<=NF; i++) if ($i=="providers") print $(i+3)}')
RESOURCE_NAME=$(echo "$SCOPE" | awk -F'/' '{print $NF}')
NAMESPACE=$(echo "$SCOPE" | awk -F'/' '{for (i=1; i<=NF; i++) if ($i=="providers") print $(i+1)}')

echo "RG: $RESOURCE_GROUP"
echo "Type: $RESOURCE_TYPE"
echo "Name: $RESOURCE_NAME"
echo "Namespace: $NAMESPACE"

locks=$(az lock list \
  --resource-group "$RESOURCE_GROUP" \
  --resource-type "$RESOURCE_TYPE" \
  --namespace "$NAMESPACE" \
  --resource-name "$RESOURCE_NAME" \
  -o json)
